

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sensor &mdash; pyvsim 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="pyvsim 1.0 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">pyvsim 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="sensor">
<h1>Sensor<a class="headerlink" href="#sensor" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pyvsim.Toolbox.Sensor">
<em class="property">class </em><tt class="descclassname">pyvsim.Toolbox.</tt><tt class="descname">Sensor</tt><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>This class describes a sensor. It is responsible for determining the size
of the camera field of view and also for recording particles.</p>
<p>The particle recording behavior is similar to the one described by Lecordier
and Westerweel in their <a class="reference external" href="http://link.springer.com/chapter/10.1007%2F978-3-642-18795-7_11">synthetic image generator</a> .</p>
<p>Some features can be easily implemented such as:</p>
<ul>
<li><dl class="first docutils">
<dt>Quantum efficiency as a function of wavelength (as the recording function</dt>
<dd><p class="first last">receives the wavelength as a parameter)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Light field measurement (the &#8220;virtualData&#8221; field can be used to store </dt>
<dd><p class="first last">more data)</p>
</dd>
</dl>
</li>
</ul>
<p>But were not implemented until now.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes sensor with gaussian noise, the distribution parameters are
given by:</p>
<ul class="simple">
<li>backgroundMeanLevel - the mean value</li>
<li>backgroundNoiseVar - the variance of the distribution</li>
</ul>
<p>To handle negative values, only the absolute value is taken into account</p>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.createDeadPixels">
<tt class="descname">createDeadPixels</tt><big>(</big><em>probability</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.createDeadPixels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.createDeadPixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dead/hot pixel mapping for the sensor reading simulation</p>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.display">
<tt class="descname">display</tt><big>(</big><em>colormap='jet'</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.display" title="Permalink to this definition">¶</a></dt>
<dd><p>This function displays what is currently recorded in the camera sensor.</p>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.parametricToPixel">
<tt class="descname">parametricToPixel</tt><big>(</big><em>coordinates</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.parametricToPixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.parametricToPixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms (normalized) parametric coordinates into pixel position on the
sensor.</p>
<p>There is an inversion of the UV columns because of the unfortunate 
parametric coordinate system that maps:</p>
<p>u -&gt; sensor.z
v -&gt; sensor.y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>coords</strong> : numpy.ndarray (N,3)</p>
<blockquote>
<div><p>The position in the sensor in normalized coordinates (range -1..1)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>pixels</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The fractional position in sensor pixels in the format [row column]</p>
</div></blockquote>
<p class="last"><strong>DOES NOT CHECK IF OUTSIDE SENSOR BOUNDARIES!!!</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.parametricToSensor">
<tt class="descname">parametricToSensor</tt><big>(</big><em>param_coords</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.parametricToSensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.parametricToSensor" title="Permalink to this definition">¶</a></dt>
<dd><p>From the parametric coordinates <img class="math" src="images/math/a7d01e2ba2f640fde0557fd977ed5652c4d4e78f.png" alt="\\overline{U,V}"/>,
which range is <img class="math" src="images/math/1f083c7eb07f00d3ffaa23b1f99f318e36e06677.png" alt="[-1..1]"/>, calculates the sensor coordinates in
meters, so the algorithm is basically multiplying by the sensor size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>param_coords</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The parametric coordinates in the range -1..1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>sensor_coords</strong> : numpy.ndarray (N,2)</p>
<blockquote class="last">
<div><p>The sensor coordinates in meters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.physicalToPixel">
<tt class="descname">physicalToPixel</tt><big>(</big><em>coords</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.physicalToPixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.physicalToPixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms world coordinates into a position in the sensor, given in
pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>coords</strong> : numpy.ndarray (N,3)</p>
<blockquote>
<div><p>The position in world coordinates</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>pixels</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The fractional position in sensor pixels in the format [row column]</p>
</div></blockquote>
<p class="last"><strong>DOES NOT CHECK IF OUTSIDE SENSOR BOUNDARIES!!!</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.readSensor">
<tt class="descname">readSensor</tt><big>(</big><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.readSensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.readSensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sensor reading in counts, creating quantization noise and
saturating the signal where appropriate. This also simulates dead pixels,
if there is a dead pixel mapping</p>
<p>The readout noise, however, should be included in the background noise
property of the class</p>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.recordParticles">
<tt class="descname">recordParticles</tt><big>(</big><em>coords</em>, <em>energy</em>, <em>wavelength</em>, <em>diameter</em>, <em>ignoreLarge=0.2</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.recordParticles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.recordParticles" title="Permalink to this definition">¶</a></dt>
<dd><p>coords     - [u,v] sensor coordinates of the recorded point
energy     - J -   energy which is captured by the lenses
wavelength - m -   illumination wavelength
diameter   - m -   particle image diameter</p>
<p>This is the front-end of the _recordParticle method, its main input
is an array of sensor coordinates, representing the particle image
centers.</p>
<p>The other inputs can be either arrays (e.g. for particle with 
varying diameters) or scalars (e.g. for all particles with same
diameter). It is more or less obvious that the arrays must have
the same length as the coordinate arrays.</p>
<p>Another issue is that the recording is much less efficient
when particle image sizes varying size (the source of this issue
is at the _recordParticles documentation). So some tricks (such
as sorting by particle size) are used to reduce this effect. This
procedure is made when the standard deviation exceeds 1/10th of the
particle diameter (ajustable by the STD_PARAM constant at the
beginning of the module).</p>
<p>Finally, as the recording itself is vectorized, but uses too much 
memory, it is made in steps. If you find problems too often, adjust
the following constants at the header of this module:</p>
<p>MEMSIZE - maximum acceptable number of elements in a numpy.ndarray</p>
<p>MEM_SAFETY - factor of safety</p>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.save">
<tt class="descname">save</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the sensor data in a 16-bit TIFF file (which is compatible
with some mainstream PIV software)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>The file name and path (including the extension)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.sensorToParametric">
<tt class="descname">sensorToParametric</tt><big>(</big><em>sensor_coords</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.sensorToParametric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.sensorToParametric" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform sensor coordinates <img class="math" src="images/math/f33002c73949e486e6ebf233fb58dc015f018b57.png" alt="(U,V)"/> in meters to parametric 
coordinates,
<img class="math" src="images/math/8ff90eaad5e07c3d9d82ca0266cd8870702b7005.png" alt="(\\overline{U},\\overline{V})"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>param_coords</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The parametric coordinates in the range -1..1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>sensor_coords</strong> : numpy.ndarray (N,2)</p>
<blockquote class="last">
<div><p>The sensor coordinates in meters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.sensorToPhysical">
<tt class="descname">sensorToPhysical</tt><big>(</big><em>sensor_coords</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.sensorToPhysical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.sensorToPhysical" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform sensor coordinates <img class="math" src="images/math/f33002c73949e486e6ebf233fb58dc015f018b57.png" alt="(U,V)"/> in meters to world coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>param_coords</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The parametric coordinates in the range -1..1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>sensor_coords</strong> : numpy.ndarray (N,3)</p>
<blockquote class="last">
<div><p>The sensor coordinates in meters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyvsim.Toolbox.Sensor.sensorToPixel">
<tt class="descname">sensorToPixel</tt><big>(</big><em>coords</em><big>)</big><a class="reference internal" href="modules/pyvsim/Toolbox.html#Sensor.sensorToPixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyvsim.Toolbox.Sensor.sensorToPixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms (normalized) parametric coordinates into pixel position on the
sensor.</p>
<p>There is an inversion of the UV columns because of the unfortunate 
parametric coordinate system that maps:</p>
<p>u -&gt; sensor.z
v -&gt; sensor.y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>coords</strong> : numpy.ndarray (N,3)</p>
<blockquote>
<div><p>The position in the sensor in normalized coordinates (range -1..1)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>pixels</strong> : numpy.ndarray (N,2)</p>
<blockquote>
<div><p>The fractional position in sensor pixels in the format [row column]</p>
</div></blockquote>
<p class="last"><strong>DOES NOT CHECK IF OUTSIDE SENSOR BOUNDARIES!!!</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="static/logo.png" alt="Logo"/>
            </a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/Sensor.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">pyvsim 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Ricardo Entz.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>